package com.cpc.spark.streaming.test

import com.cpc.spark.common.Event
import com.cpc.spark.common.Ui
import com.cpc.spark.streaming.tools.Utils
import data.Data
import java.text.SimpleDateFormat
import java.util.Date

object TestMain {

  def main(args: Array[String]) {
       /*  val line1 = "101.226.66.178 - - [28/Jun/2017:19:08:09 +0800] \"GET /show?CAAQDA.Jclq_4tXMzhGFjcX1g6bFz6zM0oiF81goRCzM0VG101GM0oyFjtXu4t7ogD1PFWuyhfhp9N-Sc194XptujcXojcXojlqcIpc_hDwojtQu0 HTTP/1.1\" 200 43 \"-\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0\" \"-\" \"-\" 0.000"
      //  val line3 = "183.204.23.226 - - [09/Jun/2017:14:15:55 +0800] \"GET /show?CAAQBg.g6ONPkWT909sYr8T90SrtMWXYB8L9B9lYy3LtB8L_jnR9otsYM8ltyJ1Yo8t0Z2ClWp3LKeU43qVjUC8_k6U9k6U9k8N6bC6P3ds9k8X9MtU968V6O88gmUbOb9tc6mPO6cbbbkqgbr0Ogc0Ik3kW6JNb63bOkYlb63bO3bVg0REijSlSxmu_rPP6A786A88g6WWbb3O866L6f8h_ktL9ktX9k8l_kpL_kpMC6t6 HTTP/1.1\" 200 43 \"http://html.1sapp.com/detail/2017/06/09/1205678.html?content_id=1205678&key=ba0c8JqbakyJN2piXzpYbRWMixCVIYLyHj6xybYuMHodafHQ0Y7TZ7dEEXqAOfbnMbs05dAYY6tv1OmZK7XK90ZM7llJCJRZrSr46x1f9karu717CtkzesW5d4KawUb23pK2MPD35pTrlC3f&pv_id=&cid=1&cat=1&rss_source=&fr=3&hj=0&skip_ad=0&v=20303&lat=34.058918&lon=114.392166&network=wifi&dc=868064022858853&dtu=001&showCoinTips=1&uuid=c6cbaddfd75a4bf4a85ede6b3095cdf8&vn=2.3.3.0527.1843&fontSize=normal\" \"Mozilla/5.0 (Linux; Android 4.4.4; OPPO R7 Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Mobile Safari/537.36 qukan_android\" \"-\" \"-\" 0.000"
         val event = Event.parse_show_log(line1)
        println(event.event)*/

        val ui_log = "NOTICE:  2018-05-05 15:12:56 * Cig2M2M3ZTNmZjAzOGE0OWFiOTJkN2E4YzQwMzY3ZmY0OWJmMjVhOTM0EPiytdcFGjsIARIIODAwMDAwMDEaACIjCg9jb20uamlmZW4ucXVrYW4SEDIuOS4xMS4wNDA4LjE2NTgqBAoAEgA6ACI3CgcxMDI2Mjc2EAEaBQhkEMgBIAAoADAAOgBAAE0AAC9EVQAAAABaAGAAagBwRngAgAHoB4oBACqNAggBEggIBRAAGAAgABoVCAESDzM1Nzc4NDA1NzA3NzMwNRgBGhYIBhIQZTE5NTIxZjE4ODRkM2NlMBgBGhUIBxIPNDYwMDE1MjMzNjE4MjkzGAEaPAgIEjZBQ0F3LTB2aWJUbERCSmQ1dzNFbWNYek52X0stSXB4R2gyNDBOelV4TkRrMU1EZzVOVEl5TlEYASIHc2Ftc3VuZyoIU00tTjkwMDYyO0RhbHZpay8yLjEuMCAoTGludXg7IFU7IEFuZHJvaWQgNS4wOyBTTS1OOTAwNiBCdWlsZC9MUlgyMVYpOgBAAEoAUg8zNTc3ODQwNTcwNzczMDVYuAhggA9qAHDpCHgCggEG5LiJ5pifMlwIAxABGAEgpOhnKN2kXzCS7l04zpNcQA9IC1CZnAJYk7YYYLSw_TRoAHDXFHi94wGAAdUJiAEAkAEAoAEAqAFksAE6ugEAwgEHMTAyNjI3NsoBANABAdgBAOgBAEAASjUIARIJCAEQyAQYACBdGiQ4MzU2ODg1MTg5YzI1YTVmYWNiZGI2NzY5NTg1YTFmZWYyYzEgAVIPCAESCzIyMy45LjU4Ljc3Wg1jdHJtb2RlbD10ZXN0Wgl0ZXN0X21sOjFaAFoPY3ZybW9kZWw9Y3ZyX3YxWgxjcGNhZG51bToxNTBaBmZ0cmFjZVoKaW50ZXJUcmc6MloIZ3NwZGM6NTBaCGJpZGRjOjcwWgVxcXVybFoJYnNyYW5rPXYzWg5jcG1kaXNjb3VudDozMFoNbm9ib3R0b21pbmdhZGIMCJwBEAwYlQEgAygBagsyMjMuOS41OC43N3ABel4KBAhkEGQKBAhuEGQKBQjQARBkCgUI1AEQZAoFCNsBEGQKBQiCARBkCgUIzgEQZQoECH0QZAoECHYQZBAEGAIgACgAMAA4AEACSLkGUABaBuWMl-S6rGIG5YyX5LqsgAGj6GeAAaLoZ4ABoOhngAGe6GeAAaboZ5AByodpkAHY_mmQAc_-aZABx_5pkAHh_GmQAdj8aZABu_xpkAGv_GmQAbnSapABs9JqkAG40mqQAdL-abIBOwgBEgAYWSDsp9UEKg4xMjcuMC4wLjE6ODA4MjCzlg44tY9PQLuPA0jK8tMEUABY4OMBYgcxMDI2Mjc2uAHEivkGwAEAygEA2gHHAXsicGVyY2VudCI6MTAwMCwiZmlyc3REc3BJbmZvIjpbeyJkc3BpZCI6MSwiZHNwUGVyY2VudCI6MTAwMH1dLCJzZWNvbmREc3BJbmZvIjpbeyJkc3BpZCI6MywiZHNwUGVyY2VudCI6MTAwMCwiZHNwUGlkIjoibW1fMjY2MzI1NDhfMjI3MzIwMTNfMTI3NzAwMDI4IiwiZHNwQmlkIjo1MDB9XSwiQm90dG9taW5nQWRCb2R5Ijp7ImNvbnRlbnQiOnt9fX0="
      /*   val ui_log="NOTICE:  2018-04-16 15:16:12 * CigyMWRkNTJlNzMzMDYzYTEzOTljMDkyYzAzYTQxZjkxMDI4MTQyYjQwELyb0dYFGjcIARIIODAwMDA2MjEaACIfChZjb20uY29vaHVhLnhpbndlbnpodWFuEgUzLjAuMCoECgASADoAIjEKBzcyNzc2MzgQARoGCJYBEN8BIAAoADAAOgBAAE0AAAAAVQAAAABaAGAAagBwZHgAKvoBCAISCAgLEAEYASAAGioIAxIkRkRDNTc2NzktRkQ4Ny00RjE4LUJCMTMtQTE3NzAyQjY5QUNEGAEiBmlQaG9uZSoGaVBob25lMm5Nb3ppbGxhLzUuMCAoaVBob25lOyBDUFUgaVBob25lIE9TIDExXzFfMSBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDQuMy41IChLSFRNTCwgbGlrZSBHZWNrbykgTW9iaWxlLzE1QjE1MDoAQABKAFIkRkRDNTc2NzktRkQ4Ny00RjE4LUJCMTMtQTE3NzAyQjY5QUNEWPcCYKwGagBwjCp4AYIBBmlQaG9uZTJWCAQQARgBIKTPZiio814w46BdOMSMPUABSAFQ2vMBWM7RQmDU7_4-aABwAHgBgAEAiAEAkAEAoAEAqAGsG7ABAboBAMIBBzcyNzc2MzjKAQDQAQPYAQBAAEoQCAMSCAgBEAYYBCAAGgAgAFITCAESDzEyMy4xMjYuMTExLjE2MloNY3RybW9kZWw9dGVzdFoJdGVzdF9tbDoxWgBaEWN2cm1vZGVsPWN2cl90ZXN0WgtjcGNhZG51bTo4MFoKaW50ZXJUcmc6MloIZ3NwZGM6NTBaCWJzcmFuaz12M2ILCJwBEAQYACACKAFqDTEyMC4yNy4yNy4xOTdwAXoSEAAYACAAKAAwADgAQAFIA1AAgAGmz2aAAZrpZLIBOQgBEgAYAyDgztkBKg4xMjcuMC4wLjE6ODA4MjCYtQo4sddIQJ8LSKyn2AFQAFifDWIHNzI3NzYzOLgB2dXsA8ABAMoBANoBbHsicGVyY2VudCI6MTAwMCwiZmlyc3REc3BJbmZvIjpbeyJkc3BpZCI6MSwiZHNwUGVyY2VudCI6MTAwMCwiZHNwQ3BtIjoxOH1dLCJCb3R0b21pbmdBZEJvZHkiOnsiY29udGVudCI6e319fQ=="
    val aslg = "NOTICE:  2018-04-16 15:12:46 * Cig1ZjEzZmNhZDEzZWE5NTNjZmI5NGEyNTY2NDdiYzUyYWFiOGEzOGZlEO6Z0dYFGjAIABIIODAwMDAwMDEaACIYCg9jb20uamlmZW4ucXVrYW4SBTIwOTAxKgQKABIAOgAiLwoHMTAyODI4NBAEGgQIABAAIAAoADAAOgBAAE0AAAAAVQAAAABaAGAAagBwZHgMKpICCAESCAgEEAQYBCAAGhYIBhIQMmQ4YmVhYTJlMDM5ZWVhOBgBGhUIARIPODY3NzkzMDI0MDQ0MDAyGAEiBlhpYW9taSoKSE0tTk9URS0xUzKTAU1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgSE0gTk9URSAxUyBCdWlsZC9LVFU4NFApIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS8zMy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNjoAQAJKAFIPODY3NzkzMDI0MDQ0MDAyWNAFYIAKagBw1wR4A4IBBuWwj-exszJVCAIQBhgBIAAoADAAOABAwD5IwD5Qg6wBWMC7_1NgAGgAcAB4wD6AAQCIAQCQAQCgAQCoAWSwATe6AQDCAQgxNzQ1NDQ1M8oBBjE0MzI0NdABANgBAEAAShAIBhIICAAQABgAIAAaACAAUhEIARINMTAxLjk1LjEwMS45MFoNY3RybW9kZWw9dGVzdFoJdGVzdF9tbDoxWgBaEWN2cm1vZGVsPWN2cl90ZXN0WgxjcGNhZG51bToxNTBaBmZ0cmFjZVoKaW50ZXJUcmc6MloIZ3NwZGM6NTBaBXFxdXJsWgxhY2NVVHlwZTowLDJaCWJzcmFuaz12M2ILCJwBEAEYACADKAFqDTEwMS45NS4xMDEuOTBwAXovCgUIyQEQZAoFCMoBEGQKBQjQARBkCgUIzAEQZBAAGAAgACgAMAA4AEABSMUEUACyATMIBhIDMTIwGAEgltDQBioZaHR0cDovL2cuZmFuY3lhcGkuY29tL3Myc2IIMTc0NTQ0NTO4AeHH5QjAAQDKAQDaAYUBeyJwZXJjZW50IjoxMDAwLCJmaXJzdERzcEluZm8iOlt7ImRzcGlkIjo1LCJkc3BQZXJjZW50IjoxMDAwLCJkc3BQaWQiOiIxNzQ1NDQ1M3wxMjAiLCJkc3BCaWQiOjUwMH1dLCJCb3R0b21pbmdBZEJvZHkiOnsiY29udGVudCI6e319fQ=="
       val as = Ui.parseData(aslg)
        println(as.ui)*/
    val as = Ui.parseData(ui_log)
        println(as.ui)
       /*   val click_log = "NOTICE:  2017-04-10 11:09:41 * CgYIABAIGAESqwIIABIoMDE4MjYyYjBlMGYyOTA1MDE4MzgxN2Y1MzNiYmQ3MjAzMDQyMDk0Nxjz7qvHBSD+/ZezCyj17qvHBTD+/ZezCzobCgg4MDAwMDAwMRIAGgAqBzEwMjUxNTYwAToAQggInAEQERjwAUoQCBcQOBhLKFc4A0ABSABaAFIECAEQLWIYChJodHRwOi8vcGVhay1mcy5jbi8QAEoAcgQIARIAegCCAQCKAUcIARIICAUQABgCIAAaFQgBEg84NjA5MDEwMzEwOTk4NzAYATgASiAxY2YyNmRiZDZiYmZhZTA4MGU5Y2E4ZWIzYTM1YzFkYpIBDAgDEggIABAAGAAgAJoBAwiQTqIBCGNwYy1iajAyqgEIY3BjLWJqMDKgBgCoBrbQqd7W7r31WA=="
         val click = Event.parse_click_log(click_log)
         println(click.event)
         
*/
    //    println(Utils.get_date_hour_from_time(1490613139000L))
//    val data_builder = Data.Log.newBuilder()
//    val field_builder = Data.Log.Field.newBuilder()
//    val map_builder = Data.Log.Field.Map.newBuilder()
//    val value_type = Data.ValueType.newBuilder()
       // val value ="NOTICE:  2018-01-18 12:01:23 * CgYIABAtGAES6gYIABIoOTNiNTExNWJiYjlhMTcxNGNiZTJmOWVlYWEzOWU5NzY0ZTVlOWJiNRict4DTBSD+7dPXAyiTuIDTBTD+7dPXAzobCgg4MDAwMDIxOBIAGgAqBzEwMjg1NjIwAToAQgkInAEQBhhCIAJKGwiGhVwQoaBdGPKkXijx5mQ4BEABWgBglMvANFIECAEQImL5AQpVaHR0cDovL3RzLnBkYWpvYi5jb20vP2ljbGljYXNoc2lkPTkzYjUxMTViYmI5YTE3MTRjYmUyZjllZWFhMzllOTc2NGU1ZTliYjUmaWNsaXR5cGU9MRAEQpsBTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMS4xOyB2aXZvIFg5cyBMIEJ1aWxkL05NRjI2Rjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS81NS4wLjI4ODMuOTEgTW9iaWxlIFNhZmFyaS81MzcuMzZKAHIECAESAHoLY3RybW9kZWw9djF6AHoPY3ZybW9kZWw9Y3ZyX3YxegtjcGNhZG51bTo4MHoKaW50ZXJUcmc6MnoIZ3NwZGM6NTB6CWJzcmFuaz12MYIBIEI0Njc5OTk0NUQ3NzNFMkE1QTYwMUI5QzZBNURDRTc1igGAAggBEggIBxABGAEgABoVCAESDzg2NjM1MzAzMzE4ODY1MxgBMpsBTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMS4xOyB2aXZvIFg5cyBMIEJ1aWxkL05NRjI2Rjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS81NS4wLjI4ODMuOTEgTW9iaWxlIFNhZmFyaS81MzcuMzY4AkIPODY2MzUzMDMzMTg4NjUzSiA4YjI5NTMxMWU3OWNkZDlmYjI2MDhkN2FlNTcxNTY2Y1CABViABWAAaASSAQwIBBIICAAQABgAIACaAQgIkE4l8AYLPqIBCGNwYy1zZTMwqgEIY3BjLXNlMDOgBgCoBoaYoqS9goewWrIGCBAAIAA4AEABugYSCg41OC4yNDQuMjQ2LjI1NBABwgYAyAYD";
     // val ui = Ui.parseData(value)
   /* val value ="NOTICE:  2018-01-18 13:00:02 * CgYIABA4GAES1wYIABIoYzI3MmRmMzYzNGZmZjVjYzE4MjA1MzExNGRkNzU4YzM2ODlhNDhmYRj50YDTBSD88PyKAyjS04DTBTD88PyKAzobCgg4MDAwMDAwMRIAGgAqBzEwMjYyNzYwAToAQgkInAEQEBgAIANKGwjUilwQ5q9dGJi+XijXtWU4BEABWgBglMvANFIECAEQI2L0AQpPaHR0cDovL3p6ei55aXpob3Utd3oxMy50b3A/aWNsaWNhc2hzaWQ9YzI3MmRmMzYzNGZmZjVjYzE4MjA1MzExNGRkNzU4YzM2ODlhNDhmYRAEQpwBTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMDsga29vYmVlIFMzMDFUIEJ1aWxkL01SQTU4Szsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS80NC4wLjI0MDMuMTE5IE1vYmlsZSBTYWZhcmkvNTM3LjM2SgByBAgBEgB6C2N0cm1vZGVsPXYyegB6D2N2cm1vZGVsPWN2cl92MXoLY3BjYWRudW06ODB6BmZ0cmFjZXoKaW50ZXJUcmc6MnoIZ3NwZGM6MTB6CGJpZGRjOjcwegVxcXVybHoJYnNyYW5rPXYxeg5jcG1kaXNjb3VudDozMIIBIDUxODJFRkQ0NjE3NzNFMkE1QTYwMjhGOUU1MEFFQTlCigGkAQgBEggIBhAAGAAgABoVCAESDzg2MjU3NzAzODAxOTU3MBgBMj9EYWx2aWsvMi4xLjAgKExpbnV4OyBVOyBBbmRyb2lkIDYuMDsga29vYmVlIFMzMDFUIEJ1aWxkL01SQTU4Syk4AEIPODYyNTc3MDM4MDE5NTcwSiBiYmViZWQ2MGYxMmVhMGY1ZTJhMTUyMDg1YTg5ZjEzNFDgA1jWBmCPA2gEkgEMCAMSCAgAEAAYACAAmgEICJBOJZbCuT2iAQhjcGMtc2UxMKoBCGNwYy1zZTAxoAYAqAa7xICCqbqKsFqyBi8KBQjJARBkCgUIygEQZAoECG4QZAoECGQQZAoFCIIBEGQKBAh9EGQQBSAAOABAAroGEAoMNDkuOTUuNTYuMTI0EAHCBgDIBgI=";
      */
/*  val log = "50.112.194.65 - - [13/Mar/2018:19:39:44 +0800] \"GET /show?CAAQPQ.FZakXmZh481i-5ahy5y9W8Zly7KJ-897W5WUP76w-iEEPe6APe1Cym1U-rPPiIggcS6uJt5GGujvrh2T4mZhWmZhWmakZ_2ZXu1xWmTl48JwWZavZaTTFKh_aZhPEuzXzZd8eEhSoto3r4HsVde8v56A_aZ_6u6TZbF4ZVT-FZakZF2YW8Zw-eJMWq2HPUbwN50Jy5h03ezvZY2sPUywN50Jy5h0PUywVUPxguxe1r-9yrMcN82xWm_v HTTP/1.1\" 200 43 \"-\" \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\" \"-\" \"-\" 0.000"
   val log2= "118.198.169.128 - - [13/Mar/2018:20:21:48 +0800] \"GET /show?CAAQOQ.mVL_08LrROezxhxN7FXrGFvleFDOGFpDGhLtGOVExikAGhjheFe9eFdgGheernhZgBvXXx7saXdf83bC7iV3GiV3GiL_V4bV0XdzGiC9GOXlGVBfVLCwmY34LVBeVLbvmQrQWzivgglea9450QNxRIX8BVp_4VX4LmaEiBXmLXVM4IL3GOXE7i6fVwbVKXSOZUYa2y6k2igOZUY5ZOYfmyx3eypA2Uja7OX3KXRhZwYDeyjfmhknZ8jEjwYU7OYfm8ZId86O7Ov3KXjzdJjE2wbGeWxOjj6td8vfGm3EKXkNdrYD2hHSZOm0V61CV6CCmVvBV6X4CVV9VLCo7iey7FCtGiCtxOXtxOAgbVeV HTTP/1.1\" 200 43 \"-\" \"Dalvik/2.1.0 (Linux; U; Android 5.1.1; NX508J Build/LMY47V)\" \"-\" \"-\" 0.000"
   var log3 ="36.149.237.62 - - [14/Mar/2018:14:07:14 +0800] \"GET /show?CAAQAw.53tJEg_Y6B0AegM_62F2ewm4sT61eRIqsTajhwPre2YPsTaqsRUPsw61Uga6-mA3bNICC653y3mHXCpFhg3Nsg3NsgtJ3cpw64ZKXT_Bxl_B6vepXTSPWDSOW5pVsw3qe2aqs23chCc5cCC3t3363tpv533a3cC3E3395t3cRCPqsw6qs2I9sgMJcaCctEPgmYtF5cFlsw3re23NECI2ewsNeVpFU1eNUlsHewcH54eN64SPxD0KhBINuCUTWVoY640H54eOmTbiUl0dLv6ruCKBWDoT7RrOUvFZsDpF6T_PUlsHeBeHglSB6b0Iuvc_hB3dsDpa6RM2URr_61Mq6RjDUwprsFpcVNCctCCFcY33l3tC3gC3aCG2ewFrs26NeB62s2FjsgRCcCgacC3 HTTP/1.1\" 200 43 \"-\" \"Mozilla/5.0 (Linux; Android 6.0.1; Redmi 4A Build/MMB29M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/55.0.2883.91 Mobile Safari/537.36\" \"-\" \"-\" 0.000" 
   val click = Event.parse_show_log(log3)
    println(switchEventAdSrc(click.event.getDspInfo.getDsp))       */ 
        
  }
   def switchEventAdSrc(idx: eventprotocol.Protocol.Dsp): Int = {
    var res: Int = 1
    idx match {
      case eventprotocol.Protocol.Dsp.CPC_DSP  => res = 1;
      case eventprotocol.Protocol.Dsp.INMOBI_DSP  => res = 2;
      case eventprotocol.Protocol.Dsp.TANX_SSP_DSP  => res = 3;
      case eventprotocol.Protocol.Dsp.BOTTOMING  => res = 4;
      case eventprotocol.Protocol.Dsp.HUZHONG_DSP  => res = 5;
      case eventprotocol.Protocol.Dsp.FANCY_DSP  => res = 6;
      case eventprotocol.Protocol.Dsp.GDT_DSP  => res = 7;
      case _ => res = idx.getNumber;
    }
    res
  }
}